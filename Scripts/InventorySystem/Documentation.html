<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>JG Inventory System – Quick Guide (v2)</title>
    <style>
        body {
            font-family: system-ui, sans-serif;
            line-height: 1.55;
            max-width: 65rem;
            margin: 2rem auto;
            padding: 0 1.2rem
        }

        h1,
        h2 {
            color: #2c3e50;
            margin-top: 1.8rem
        }

        code {
            background: #f4f4f4;
            padding: .12rem .35rem;
            border-radius: 3px
        }

        pre {
            background: #f4f4f4;
            padding: .8rem 1rem;
            border-radius: 4px;
            overflow-x: auto
        }

        ol li {
            margin-bottom: .55rem
        }

        .note {
            font-size: .9em;
            color: #666
        }

        table {
            border-collapse: collapse;
            margin: .5rem 0
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: .25rem .5rem;
            text-align: left
        }
    </style>
</head>

<body>
    <h1>JG Inventory System (Unity 2022.3 URP)</h1>

    <p>This document supersedes the earlier quick-start guide and adds the new
        <strong>InventoryComponent</strong>, <strong>EquipmentSlotComponent</strong>,
        starter-item bundles, and UI-prefab
        workflow.:contentReference[oaicite:0]{index=0}:contentReference[oaicite:1]{index=1}
    </p>

    <ol>
        <li>Folder layout &amp; load order</li>
        <li>Item JSON formats (single & multi-item)</li>
        <li>Starter-item JSON format (single & multi-seed) + InventoryComponent</li>
        <li>Runtime API cheat-sheet</li>
        <li>Editor tool – Item Catalog Browser</li>
        <li>Scene/UI wiring checklist</li>
    </ol>



    <h2>1 · Folder &amp; Load Order</h2>

    <p>The catalog merges <em>three waves</em>; later waves override earlier ones on duplicate
        <code>id</code>s.
    </p>
    <ol>
        <li><strong>Designer assets</strong> – every <code>ItemData</code> ScriptableObject in
            <code>Resources/Items/</code>
        </li>
        <li><strong>Resource JSON files</strong> – list of
            <em>TextAssets</em> assigned in <code>ItemCatalog</code> Inspector
            (default entry: <code>Resources/Items/items.json</code>)
        </li>
        <li><strong>StreamingAssets folders</strong> – every
            <code>*.json</code> in the Inspector-listed sub-directories
            (<code>StreamingAssets/Items</code>, <code>StreamingAssets/Mods/&lt;name&gt;</code>, …)
        </li>
    </ol>

    <p class="note">Inject further files at runtime:</p>
    <pre><code>string mod = Path.Combine(Application.persistentDataPath, "Mods/MyMod/items.json");
ItemCatalog.Instance.ImportModFile(mod, canOverride:true);</code></pre>



    <h2>2 · Item JSON Authoring</h2>

    <h3>2.1 Single-item file (legacy)</h3>
    <pre><code>{
  "id":"potion_health_small",
  "displayName":"Minor Healing Potion",
  "maxStack":10,
  "equipTags":[],
  "effects":[
    { "effectType":"Heal", "effectParams":"{ \"amount\":25 }" }
  ]
}</code></pre>

    <h3>2.2 Multi-item bundle</h3>
    <pre><code>{
  "items":[
    {
      "id":"potion_health_small",
      "displayName":"Minor Healing Potion",
      "maxStack":10,
      "equipTags":[],
      "effects":[{ "effectType":"Heal", "effectParams":"{ \"amount\":25 }" }]
    },
    {
      "id":"scroll_fireball",
      "displayName":"Scroll of Fireball",
      "maxStack":1,
      "equipTags":[],
      "effects":[{ "effectType":"CastSpell", "effectParams":"{ \"spell\":\"Fireball\" }" }]
    }
  ],
  "modName":"Core Items",
  "formatVersion":1
}</code></pre>



    <h2>3 · Starter-Item JSON (InventoryComponent)</h2>

    <p>Add one or more <strong>TextAssets</strong> to <kbd>InventoryComponent ▸ Starter Item Files</kbd>.
        Each file may contain one seed object or a wrapper with many seeds.</p>

    <table>
        <tr>
            <th>Single-seed file</th>
            <th>Multi-seed file</th>
        </tr>
        <tr>
            <td width="50%">
                <pre><code>{
  "id":"potion_health_small",
  "quantity":5
}</code></pre>
            </td>
            <td width="50%">
                <pre><code>{
  "items":[
    { "id":"potion_health_small", "quantity":5 },
    { "id":"scroll_fireball",     "quantity":2 },
    { "id":"gold_coin",           "quantity":100 }
  ]
}</code></pre>
            </td>
        </tr>
    </table>



    <h2>4 · Runtime API Cheat-Sheet</h2>
    <pre><code>// static lookup
ItemData potion = ItemCatalog.Instance.Get("potion_health_small");

// inventory via wrapper component
var inv = player.GetComponent&lt;InventoryComponent&gt;().Runtime;

// add 3 potions
inv.AddItem(potion, 3);

// use one potion
inv.UseItem("potion_health_small", new InventoryContext { TargetStats = playerStats });
</code></pre>



    <h2>5 · Editor Tool – Item Catalog Browser</h2>

    <ol>
        <li>Enter <strong>Play Mode</strong> so JSON items are loaded.</li>
        <li>Open <kbd>Window ▸ JG Inventory ▸ Item Catalog Browser</kbd>.</li>
        <li>Click any item to view stack limit, equip tags and raw effect definitions.</li>
    </ol>

    <p class="note">In Edit Mode only the ScriptableObjects under
        <code>Resources/Items</code> appear.
    </p>



    <h2>6 · Scene &amp; UI Wiring (new)</h2>

    <ol>
        <li>Add <strong>InventoryComponent</strong> to the player root.<br>
            • Optionally assign starter-item TextAssets.</li>
        <li>Under a child “Equipment” GameObject create one object per slot
            (“HeadSlot”, “BodySlot”, …) and attach <strong>EquipmentSlotComponent</strong>.
            Fill its <kbd>Accepted Tags</kbd> array (e.g. <code>Head</code>).</li>
        <li>Attach <strong>PlayerEquipmentBridge</strong> to the player root
            (auto-discovers all <code>EquipmentSlotComponent</code>s on children).</li>
        <li><strong>InventoryPanel</strong> → assign <kbd>InventoryComponent</kbd> reference
            in <code>InventoryUI</code> (auto-finds if none).</li>
        <li><strong>EquipmentPanel</strong> → for every visible slot button create a binding:<br>
            • <kbd>Button</kbd> reference<br>
            • corresponding <kbd>EquipmentSlotComponent</kbd><br>
            • <kbd>Icon Image</kbd> & <kbd>Qty Text</kbd></li>
    </ol>

    <p>Right-click any inventory slot during play to bring up the context
        menu (Use / Equip / Drop). Equip is enabled only if the selected
        <code>ItemData.EquipTags</code> intersects the slot’s accepted tags.
    </p>



    <h2>7 · Adding New Effects (recap)</h2>
    <ol>
        <li>Implement <code>IItemEffect</code>.</li>
        <li>Decorate with <code>[ItemEffect("Id")]</code>.</li>
        <li>Provide <code>static IItemEffect FromJson(string)</code>.</li>
        <li>Register in a one-liner:<br>
            <code>static NewFx() => ItemEffectRegistry.Register&lt;NewFx&gt;(FromJson);</code>
        </li>
    </ol>



    <hr>
    <p class="note">© 2025 JG.Inventory — tested on Unity 2022.3 URP</p>
</body>

</html>