<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>JG Inventory System – Quick Guide</title>
    <style>
        body {
            font-family: system-ui, sans-serif;
            line-height: 1.55;
            max-width: 65rem;
            margin: 2rem auto;
            padding: 0 1.2rem
        }

        h1,
        h2 {
            color: #2c3e50;
            margin-top: 1.8rem
        }

        code {
            background: #f4f4f4;
            padding: .12rem .35rem;
            border-radius: 3px
        }

        pre {
            background: #f4f4f4;
            padding: .8rem 1rem;
            border-radius: 4px;
            overflow-x: auto
        }

        ol li {
            margin-bottom: .55rem
        }

        .note {
            font-size: .9em;
            color: #666
        }
    </style>
</head>

<body>
    <h1>JG Inventory System (2022.3 URP)</h1>

    <p>This document covers:</p>
    <ol>
        <li>Folder layout &amp; load order</li>
        <li>JSON formats (one-item <em>or</em> multi-item)</li>
        <li>Runtime API cheat-sheet</li>
        <li>New <strong>Item Catalog Browser</strong> window</li>
    </ol>



    <h2>1 · Folder &amp; Load Order</h2>

    <p>The catalog merges <em>three waves</em> of data; later waves override earlier ones if two items share the same
        <code>id</code>.
    </p>

    <ol>
        <li><strong>Designer assets</strong> – every <code>ItemData</code> ScriptableObject under
            <code>Resources/Items/</code>
        </li>
        <li><strong>Resource JSON files</strong> – list of <em>TextAssets</em> set in the <code>ItemCatalog</code>
            Inspector (default entry: <code>Resources/Items/items.json</code>)</li>
        <li><strong>StreamingAssets folders</strong> – all <code>*.json</code> files found in the directories listed in
            the Inspector (e.g.&nbsp;<code>StreamingAssets/Items</code>, <code>StreamingAssets/Mods/MyMod</code>)</li>
    </ol>

    <p class="note">At runtime you can inject additional files on the fly:</p>
    <pre><code>string modPath = Path.Combine(Application.persistentDataPath, "Mods/MyMod/items.json");
ItemCatalog.Instance.ImportModFile(modPath, canOverride: true);</code></pre>



    <h2>2 · JSON Authoring</h2>

    <h3>2.1 Single-item file (legacy)</h3>
    <pre><code>{
  "id":"potion_health_small",
  "displayName":"Minor Healing Potion",
  "maxStack":10,
  "equipTags":[],
  "effects":[
    { "effectType":"Heal", "effectParams":"{ \"amount\":25 }" }
  ]
}</code></pre>

    <h3>2.2 Multi-item bundle</h3>
    <pre><code>{
  "items":[
    {
      "id":"potion_health_small",
      "displayName":"Minor Healing Potion",
      "maxStack":10,
      "equipTags":[],
      "effects":[ { "effectType":"Heal", "effectParams":"{ \"amount\":25 }" } ]
    },
    {
      "id":"scroll_fireball",
      "displayName":"Scroll of Fireball",
      "maxStack":1,
      "equipTags":[],
      "effects":[ { "effectType":"CastSpell", "effectParams":"{ \"spell\":\"Fireball\" }" } ]
    }
  ],
  "modName":"Core Items",
  "formatVersion":1
}</code></pre>

    <ul>
        <li><code>effectType</code> must match the identifier in <code>[ItemEffect("Heal")]</code> (not necessarily the
            class name).</li>
        <li><code>effectParams</code> is free-form JSON parsed by the effect’s own factory.</li>
    </ul>



    <h2>3 · Runtime API Cheat-Sheet</h2>
    <pre><code>// lookup static data
ItemData potion = ItemCatalog.Instance.Get("potion_health_small");

// player inventory
var inv = new Inventory();
inv.AddItem(potion, 3);

var ctx = new InventoryContext {
    TargetStats = playerStats,
    Resources   = playerWallet
};

inv.UseItem("potion_health_small", ctx); // Heal for 25, remove 1 stack

// resources &amp; currencies
ctx.Resources.Add("gold", 50);
bool ok = ctx.Resources.Spend("gold", 30);   // false if insufficient
</code></pre>



    <h2>4 · Editor Tool – Item Catalog Browser</h2>

    <ol>
        <li>Enter <strong>Play Mode</strong> (so JSON items are in memory).</li>
        <li>Open <code>Window ▸ JG Inventory ▸ Item Catalog Browser</code>.</li>
        <li>Scroll through the list – click an item to reveal:<br>
            &nbsp;&nbsp;• Max stack<br>
            &nbsp;&nbsp;• Equip tags<br>
            &nbsp;&nbsp;• All effect definitions and their raw parameter JSON
        </li>
    </ol>

    <p class="note">Outside Play Mode the browser lists only the ScriptableObjects found in
        <code>Resources/Items</code>.
    </p>



    <h2>5 · Adding New Effects</h2>
    <ol>
        <li>Implement <code>IItemEffect</code>.</li>
        <li>Add an attribute: <code>[ItemEffect("Shield")]</code>.</li>
        <li>Expose <code>static IItemEffect FromJson(string)</code> and register:</li>
    </ol>
    <pre><code>[ItemEffect("Shield")]
public class ShieldEffect : IItemEffect {
    public static IItemEffect FromJson(string j){ … }
    static ShieldEffect() => ItemEffectRegistry.Register&lt;ShieldEffect&gt;(FromJson);
}</code></pre>



    <hr>
    <p class="note">&copy; 2025 JG.Inventory &nbsp;—&nbsp;tested on Unity 2022.3 URP</p>
</body>

</html>